# Bird Dive Challenge - UE5.6 ゲーム設計詳細書

## 概要

- **開発環境**：Unreal Engine 5.6
- **ジャンル**：スコアアタック型落下アクション
- **キャラクター**：難易度別に複数種の鳥（Easy, Normal, Hard）
- **特徴**  
    - 風の影響によるランダムな逸れ挙動
    - 2画面表示（鳥の視点＋横からの視点）
    - 地面到達タイム＆着地位置で得点
    - 着地速度が一定値を超えると失格
    - 着地時にNiagaraエフェクト
    - アニメーションはControlRigで制御

---

## 1. ゲーム仕様

| 項目         | 内容                                                            |
|--------------|-----------------------------------------------------------------|
| キャラクター | 難易度ごとにパラメータの異なる鳥（アセット流用or自作）          |
| 得点計算     | 地面到達タイム・着地位置（的の中心との距離）で決定              |
| 失格条件     | 着地速度が閾値より大きい場合                                    |
| 風の影響     | 毎フレーム横方向にノイズベースの外力を与える                    |
| カメラ       | 2画面分割（Split Viewport）：主観視点（歪み有）＋横視点         |
| UI           | スコア・タイマー・失格時の警告・リザルト画面                    |
| サウンド     | 落下音・風音・着地音・エフェクト音など                          |
| エフェクト   | Niagaraによる着地エフェクト等                                   |
| アニメーション| ControlRigによる羽ばたき・姿勢制御など                          |

---

## 2. 難易度ごとのパラメータ例

| 難易度 | 風の強さ | 許容速度 | 操作性 |
|--------|----------|----------|--------|
| Easy   | 弱い     | 高い     | 安定   |
| Normal | 普通     | 普通     | 普通   |
| Hard   | 強い     | 低い     | 不安定 |

---

## 3. 実装詳細

### 3.1 ビューポート分割（2画面表示）

- UE5.6のSplit Screenまたは複数カメラによるViewport描画
- **画面1**：鳥の主観視点（速度に応じたポストプロセスで歪み/モーションブラー）
- **画面2**：横から見た俯瞰視点（追従カメラ）

### 3.2 鳥キャラクター

- UE5 Characterクラスを継承しBlueprint化
- 鳥の3Dアセット取得（Marketplaceや自作、フリー素材も検討）
- 各鳥のパラメータはDataTableやBPで管理
- ControlRigでアニメーションを制御  
    - 羽ばたき、体のひねりなど

#### 風の実装例（C++擬似）
```cpp
float windNoise = FMath::PerlinNoise1D(GetWorld()->GetTimeSeconds() * 0.15f + BirdID);
FVector WindForce = FVector::RightVector * WindStrength * windNoise;
GetCharacterMovement()->AddForce(WindForce);
```

### 3.3 アニメーション（ControlRig）

- 鳥の骨格をControlRigでリグ設定
- 羽ばたきや風の影響による姿勢変化をリグで実装
- アニメーションブループリントで状態遷移管理

### 3.4 着地判定・スコア・失格ロジック

- 着地はコリジョンまたはOnHitで判定
- 着地時の速度（`GetVelocity()`）で失格条件判定
- 到達位置（ターゲット中心との距離）とタイムでスコア計算
- 着地時にNiagaraでエフェクト再生

### 3.5 ポストプロセスエフェクト

- 主観カメラの速度パラメータをMaterialへ渡しFOV/歪み/ブラーを制御
- ポストプロセスはBlueprintでリアルタイムにパラメータ調整

### 3.6 UI設計

- UMGでスコア・タイマー・リザルトなど表示
- 失格時にはダイアログやアニメーション表示

### 3.7 サウンド

- 環境音（風、落下）
- 効果音（羽ばたき、着地、失格時の音など）

---

## 4. 推奨フォルダ構成

```
/BirdDive
 ├ Assets
 │   ├ Birds          # 鳥の3Dアセット
 │   └ Effects        # Niagaraエフェクト
 ├ Blueprints
 │   ├ BP_BirdCharacter
 │   ├ BP_SideCamera
 │   └ BP_GameMode
 ├ ControlRig
 │   └ CR_Bird
 ├ Materials
 │   └ M_PostProcessSpeedDistort
 ├ UI
 │   └ Widget_ScoreTimer
 ├ Sound
 │   └ SE, BGM
 ├ Maps
 │   └ MainMap
```

---

## 5. 作業チケット・大枠（タスク分割例）

1. **プロジェクトセットアップ**
   - UE5.6新規プロジェクト作成・バージョン管理設定

2. **ビューポート分割の実装**
   - 2画面（主観・横）カメラ設置、分割描画ロジック実装
   - 鳥の視点カメラのポストプロセス歪み制御

3. **鳥のアセット取得・セットアップ**
   - 3Dモデル取得・インポート
   - スケルタル設定とマテリアル調整

4. **鳥アニメーション開発（ControlRig）**
   - ControlRigによる羽ばたき・姿勢制御
   - アニメーションBP作成、遷移管理

5. **物理挙動・風の実装**
   - Tickごとの外力（風）加算
   - 難易度ごとのパラメータ適用

6. **着地判定＆Niagaraエフェクト**
   - コリジョンで着地判定
   - Niagaraエフェクトの作成と再生
   - 着地速度失格ロジック

7. **得点・失格ロジック実装**
   - スコア計算、失格判定UI

8. **UI開発**
   - UMGでスコア・タイマー・リザルト表示

9. **サウンド実装**
   - 必要な効果音・BGMの追加

10. **最終デバッグ・調整**

---

